<?xml version='1.1' encoding='UTF-8'?>
<xwikidoc version="1.5" reference="JIRA.JiraPaste.GetConfiguredUrls" locale="">
  <web>JIRA.JiraPaste</web>
  <name>GetConfiguredUrls</name>
  <language/>
  <defaultLanguage>en</defaultLanguage>
  <translation>0</translation>
  <creator>XWiki.Admin</creator>
  <creationDate>1737462516000</creationDate>
  <parent>WebHome</parent>
  <author>XWiki.Admin</author>
  <originalMetadataAuthor>XWiki.Admin</originalMetadataAuthor>
  <contentAuthor>XWiki.Admin</contentAuthor>
  <date>1737495040000</date>
  <contentUpdateDate>1737467501000</contentUpdateDate>
  <version>1.5</version>
  <title>GetConfiguredUrls</title>
  <comment>Update document after refactoring.</comment>
  <minorEdit>true</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>false</hidden>
  <content>{{velocity}}
#if ($xcontext.action == 'get')
  #set ($jiraCfgRef = $services.model.createDocumentReference('', 'JIRA', 'JIRAConfig'))
  #set ($jiraCfgDoc = $xwiki.getDocument($jiraCfgRef))
  #set ($jiraCfgObjs = $jiraCfgDoc.getObjects('JIRA.JIRAConfigClass'))
  #set ($instancesDetails = [])
  #foreach ($instance in $jiraCfgObjs)
    #set ($instanceDetails = {})
    #set ($instanceUrl = "$!instance.getProperty('url').getValue()")
    #if (!$instanceUrl.isEmpty())
      #set ($discard = $instanceDetails.put('url', $instanceUrl))
    #end
    #set ($instanceId = "$!instance.getProperty('id').getValue()")
    #if (!$instanceId.isEmpty())
      #set ($discard = $instanceDetails.put('id', $instanceId))
    #end
    #if (!$instanceDetails.isEmpty())
      #set ($discard = $instancesDetails.add($instanceDetails))
    #end
  #end
  #set ($discard = $response.setContentType('application/json'))
  $jsontool.serialize($instancesDetails)
#end
{{/velocity}}</content>
</xwikidoc>